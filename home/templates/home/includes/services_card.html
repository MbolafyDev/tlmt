{% load static %}

<div class="col-md-9">
      <h3>Nos Services & Travaux Réalisés</h3>
      <div class="row g-4 d-flex align-items-stretch">
        {% for service in services %}
        <div class="col-sm-6 col-md-6 col-lg-4">
          <div class="service-card shadow-sm">
            {% if service.images.exists %}
              <img src="{{ service.images.first.image.url }}" alt="{{ service.titre }}">
            {% else %}
              <img src="{% static 'images/default.png' %}" alt="{{ service.titre }}">
            {% endif %}
            <div class="card-body d-flex flex-column justify-content-between">
              {% with statut_display=service.get_statut_display %}
                {% if statut_display %}
                  {% if statut_display == "Planifié" %}
                    <span class="badge bg-warning">{{ statut_display }}</span>
                  {% elif statut_display == "En cours" %}
                    <span class="badge bg-secondary">{{ statut_display }}</span>
                  {% elif statut_display == "Terminé" %}
                    <span class="badge bg-success">{{ statut_display }}</span>
                  {% endif %}
                {% endif %}
              {% endwith %}
              <h5 class="card-title mt-2">{{ service.titre }}</h5>
              <p class="card-text">
                {% if service.description %}
                  {% if service.description|length > 50 %}
                    {{ service.description|slice:":50" }}...
                  {% else %}
                    {{ service.description }}
                  {% endif %}
                  <a href="#" class="voir-plus-service" data-service-id="{{ service.id }}">Voir plus</a>
                {% else %}
                  Aucune description disponible.
                {% endif %}
              </p>
              {% if user.is_authenticated %}
              <div class="d-flex gap-2 mt-2">
                <button class="btn btn-like btn-sm" data-service-id="{{ service.id }}">
                  <i class="fas fa-thumbs-up"></i>
                  <span class="like-count">{{ service.likes_count }}</span>
                </button>
                <button class="btn btn-comment btn-sm" data-service-id="{{ service.id }}" data-bs-toggle="modal" data-bs-target="#commentModal">
                  <i class="fas fa-comment"></i>
                  <span class="comment-count">{{ service.comments_count }}</span>
                </button>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>